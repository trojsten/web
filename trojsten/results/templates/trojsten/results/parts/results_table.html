{% load utils %}
<table class="table table-hover table-responsive">
<thead>
<tr>
    <th>#</th>
    <th>Meno:</th>
    <th>Škola</th>
    <th>Ročník</th>
    {% if show_previous_results %}
        <th>Predošlé kolá</th>
    {% endif %}
    {% for task in tasks %}
        <th>{{task.number}}</th>
    {% endfor %}
    <th>Suma:</th>
</tr>
</thead>
{% for result in results %}
{% spaceless %}
<tr {% if user == result.user %}class="active"{%endif%}>
    <td>{{forloop.counter}}</td>
    <td>{{result.user.first_name}} {{result.user.last_name}}</td>
    <td>{%if result.user.school.has_abbreviation %}<abbr title="{{result.user.school.verbose_name}}">{{result.user.school.abbreviation}}</abbr>{%else%}{{result.user.school.verbose_name}}{%endif%}</td>
    <td>{{result.user.school_year}}</td>
    {% if show_previous_results %}
        <td>{{result.previous_points}}</td>
    {% endif %}
    {% for task in tasks %}
        <td>
        {% if result.points|lookup:task|lookup:"submitted" %}
            <span data-toggle="tooltip" data-placement="top" title="{% if task.description_points > 0 %}popis: {{result.points|lookup:task|lookup:'description'}}{% if task.source_points > 0 %} {% endif %}{% endif %}{% if task.source_points > 0 %}program: {{result.points|lookup:task|lookup:'source'}}{% endif %}">
                {{result.points|lookup:task|lookup:"sum"}}
            </span>
        {% endif %}
        </td>
    {% endfor %}

    <td>{{result.sum}}</td>
</tr>
{% endspaceless %}
{% empty %}
<tr><td colspan="{{tasks | length | add:3}}">Žiadne submity</td></tr>
{% endfor %}
</table>
